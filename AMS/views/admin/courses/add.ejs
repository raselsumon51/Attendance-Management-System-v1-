<style>
  .upload-course-xl{
    height: 91vh;
  }

</style>



<div class="container upload-course-xl d-flex align-items-center justify-content-center">
  <div class="col-md-8 py-md-4 px-md-5 mt-lg-0 pb-2 py-4">
    <div id="message" class="text-center">
      <% if (saved) { %>
        <div class="alert alert-success alert-dismissible fade show" role="alert">
          <span>Courses have been successfully added!</span>
          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
      <% } %>
    </div>

    <h3 class="text-center py-md-2 pb-2 pt-4">Upload Excel File</h3>
    <form action="/admin-dashboard/upload-courses" method="post" enctype="multipart/form-data">
      <div class="mb-3">
        <label for="course_file" class="form-label pb-lg-2">Select an Excel File</label>
        <input type="file" class="form-control" id="course_file" name="course_file" accept=".xlsx,.xls" required>
      </div>

      <div class="d-flex justify-content-center mt-3">
        <button type="submit" class="btn btn-primary w-25">Upload</button>
      </div>
    </form>
    <p class="text-center pt-3"><a href="/admin-dashboard/add-courses-manually" class="text-decoration-none">Add Course manually?</a></p>
  </div>
</div>



<script>
  document.addEventListener("DOMContentLoaded", function() {
    const closeButton = document.querySelector(".btn-close");
    const successAlert = document.getElementById("success");

    function closeSuccessMessage() {
      let opacity = 1;
      const animationInterval = setInterval(() => {
        opacity -= 0.05;
        successAlert.style.opacity = opacity;
        if (opacity <= 0) {
          successAlert.style.visibility = "hidden";
          clearInterval(animationInterval);
        }
      }, 20);
    }

    if (closeButton) {
      closeButton.addEventListener("click", () => {
        closeSuccessMessage();
      });
    }
  });
</script>
